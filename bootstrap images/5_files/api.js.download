var intendo=function(){this.access_key="",this.utils=new TTUtils,this.createOrder=function(e,t){var i={user_type:"guest",object_type:"product",action_type:"place_order",tt_order_id:this.utils.get_tt_sid()};if(void 0!==e&&"user"in e&&(("id"in e.user||"email"in e.user)&&((this.utils.validateEmail(e.user.id)||this.utils.validateEmail(e.user.email))&&(i.user_type="email"),i.user_id=e.user.id),i.user=e.user),void 0!==t)for(var s in t)i[s]=t[s];window.localStorage.order=JSON.stringify(i),window.addEventListener("beforeunload",function(){this.utils.post(i,!0,!1)})},this.setOrderAttribute=function(e,t){var i=this.utils.getFromLocalStorage("order",{});void 0!==e&&"user"in e&&(("id"in e.user||"email"in e.user)&&((this.utils.validateEmail(e.user.id)||this.utils.validateEmail(e.user.email))&&(i.user_type="email"),i.user_id=e.user.id),i.user=e.user);for(var s in t)i[s]=t[s];window.localStorage.order=i,window.addEventListener("beforeunload",function(){this.utils.post(i,!0,!1)})},this.addItemsToOrder=function(e,t){var i=this.utils.getFromLocalStorage("order",{});if(void 0!==e&&(("id"in e||"email"in e)&&((this.utils.validateEmail(e.id)||this.utils.validateEmail(e.email))&&(i.user_type="email"),i.user_id=e.id),i.user=e),"meta"in i||(i.meta={}),"orders"in i.meta||(i.meta.orders=[]),"object"==typeof t)if("[object Array]"===Object.prototype.toString.call(t))for(var s=0;s<t.length;s++)i.meta.orders.push(t[s]);else i.meta.orders.push(t);window.localStorage.order=JSON.stringify(i)},this.placeOrder=function(e,t){var i=this.utils.getFromLocalStorage("order",{user_type:"guest",object_type:"product",action_type:"place_order"});this.access_key.length>0&&(i.access_key=this.access_key),void 0!==e&&(("id"in e||"email"in e)&&((this.utils.validateEmail(e.id)||this.utils.validateEmail(e.email))&&(i.user_type="email"),i.user_id=e.id),i.user=e);var s=[];for(var r in t)if("id"==r)i.object_id=t[r],s.push(i.object_id);else if("products"==r){i.meta={},i.meta.orders=t[r];for(var a=0;a<t.length;a++)o=t[a],"object"==typeof o&&o.product_id?s.push(o.product_id):"string"==typeof o&&s.push(o)}else i[r]=t[r];this.utils.post(i,!1,!1);for(a=0;a<s.length;a++)this.utils.addSessionProduct("negative",s[a]),this.utils.removeSessionProduct("positive",s[a])},this.cancelOrder=function(e,t,i){i=this.utils.validateArgument(i,!0);var s={user_type:"guest",object_type:"product",action_type:"cancel_order"};if(this.access_key.length>0&&(s.access_key=this.access_key),void 0!==e&&(("id"in e||"email"in e)&&((this.utils.validateEmail(e.id)||this.utils.validateEmail(e.email))&&(s.user_type="email"),s.user_id=e.id),s.user=e),void 0!==t)for(var o in t)s[o]=t[o];"id"in s&&(s.object_id=s.id,delete s.id),this.utils.post(s,i,!1)},this.addItemToCart=function(e,t,i){i=this.utils.validateArgument(i,!0);var s={user_type:"guest",object_type:"product",action_type:"add_to_cart"};if(this.access_key.length>0&&(s.access_key=this.access_key),void 0!==e&&(("id"in e||"email"in e)&&((this.utils.validateEmail(e.id)||this.utils.validateEmail(e.email))&&(s.user_type="email"),s.user_id=e.id),s.user=e),void 0!==t){for(var o in t)s[o]=t[o];"id"in s?(s.object_id=s.id,delete s.id):"product_id"in s&&(s.object_id=s.product_id,delete s.product_id)}this.utils.post(s,i,!1),this.utils.removeSessionProduct("positive",s.object_id),this.utils.addSessionProduct("negative",s.object_id)},this.addItemsToCart=function(e,t,i){if("object"==typeof t&&"[object Array]"===Object.prototype.toString.call(t))for(var s=0;s<t.length;s++)this.addItemToCart(e,t[s],i)},this.setCartItemAttributes=function(e,t,i){this.addItemToCart(e,t,i)},this.removeItemFromCart=function(e,t,i){i=this.utils.validateArgument(i,!0);var s={user_type:"guest",object_type:"product",action_type:"remove_from_cart"};if(this.access_key.length>0&&(s.access_key=this.access_key),void 0!==e&&(("id"in e||"email"in e)&&((this.utils.validateEmail(e.id)||this.utils.validateEmail(e.email))&&(s.user_type="email"),s.user_id=e.id),s.user=e),void 0!==t){for(var o in t)s[o]=t[o];"id"in s?(s.object_id=s.id,delete s.id):"product_id"in s&&(s.object_id=s.product_id,delete s.product_id)}this.utils.post(s,i,!1),this.utils.removeSessionProduct("negative",s.object_id)},this.addItemToWishlist=function(e,t,i){i=this.utils.validateArgument(i,!0);var s={user_type:"guest",object_type:"product",action_type:"add_to_wishlist"};if(this.access_key.length>0&&(s.access_key=this.access_key),void 0!==e&&(("id"in e||"email"in e)&&((this.utils.validateEmail(e.id)||this.utils.validateEmail(e.email))&&(s.user_type="email"),s.user_id=e.id),s.user=e),void 0!==t)for(var o in t)s[o]=t[o];"id"in s?(s.object_id=s.id,delete s.id):"product_id"in s&&(s.object_id=s.product_id,delete s.product_id),this.utils.post(s,i,!1)},this.removeFromWishlist=function(e,t,i){i=this.utils.validateArgument(i,!0);var s={user_type:"guest",object_type:"product",action_type:"remove_from_wishlist"};this.access_key.length>0&&(s.access_key=this.access_key),void 0!==e&&(("id"in e||"email"in e)&&((this.utils.validateEmail(e.id)||this.utils.validateEmail(e.email))&&(s.user_type="email"),s.user_id=e.id),s.user=e);for(var o in t)s[o]=t[o];"id"in s?(s.object_id=s.id,delete s.id):"product_id"in s&&(s.object_id=s.product_id,delete s.product_id),this.utils.post(s,i,!1)},this.viewProductPage=function(e,t,i){i=this.utils.validateArgument(i,!0);var s={user_type:"guest",object_type:"product",action_type:"view"};this.access_key.length>0&&(s.access_key=this.access_key),void 0!==e&&(("id"in e||"email"in e)&&((this.utils.validateEmail(e.id)||this.utils.validateEmail(e.email))&&(s.user_type="email"),s.user_id=e.id),s.user=e);for(var o in t)s[o]=t[o];if("id"in s?(s.object_id=s.id,delete s.id):"product_id"in s&&(s.object_id=s.product_id,delete s.product_id),window.localStorage){var r=localStorage.getItem("cem.recentlyViewed");if("object_id"in s)if(localStorage.setItem("cem.currentlyViewed",s.object_id),r){var a=(r=r.split(",")).indexOf(s.object_id);-1!==a&&r.splice(a,1),r.splice(0,0,s.object_id),r.splice(20),localStorage.setItem("cem.recentlyViewed",r),this.utils.setCookie("cem.recentlyViewed",r,100)}else localStorage.setItem("cem.recentlyViewed",s.object_id),this.utils.setCookie("cem.recentlyViewed",s.object_id,100)}this.utils.post(s,i,!1),this.utils.addSessionProduct("positive",s.object_id)},this.viewProduct=function(e,t,i){this.viewProductPage(e,t,i)},this.userSignup=function(e,t){t=this.utils.validateArgument(t,!0);var i={user_type:"email",action_type:"register",object_type:"user"};if(this.access_key.length>0&&(i.access_key=this.access_key),void 0!==e&&("id"in e||"email"in e)&&(this.utils.validateEmail(e.id)||this.utils.validateEmail(e.email))){i.user_id=e.id||e.email,i.object_id=e.id||e.email,i.user=e;for(var s in e)i[s]=e[s];this.utils.post(i,t,!1)}},this.viewCollectionPage=function(e,t,i){i=this.utils.validateArgument(i,!0);var s={user_type:"guest",object_type:"collection",action_type:"view"};this.access_key.length>0&&(s.access_key=this.access_key),void 0!==e&&(("id"in e||"email"in e)&&((this.utils.validateEmail(e.id)||this.utils.validateEmail(e.email))&&(s.user_type="email"),s.user_id=e.id),s.user=e);for(var o in t)s[o]=t[o];"collection_name"in s&&(s.object_id=s.collection_name,delete s.collection_name),this.utils.post(s,i,!1)},this.viewPage=function(e,t,i){i=this.utils.validateArgument(i,!0);var s={user_type:"guest",action_type:"view"};if(this.access_key.length>0&&(s.access_key=this.access_key),void 0!==e&&(("id"in e||"email"in e)&&((this.utils.validateEmail(e.id)||this.utils.validateEmail(e.email))&&(s.user_type="email"),s.user_id=e.id),s.user=e),void 0!==t){void 0!=t.pagetype&&(t.page_type=t.pagetype),"page_type"in t&&!("object_type"in t)&&(s.object_type="page",s.object_id=t.page_type,delete s.page_type);for(var o in t)s[o]=t[o]}this.utils.post(s,i,!1)},this.userSubscribeToNewsletter=function(e,t){t=this.utils.validateArgument(t,!0);var i={user_type:"email",action_type:"subscribe_to_newsletter",object_type:"user"};if(this.access_key.length>0&&(i.access_key=this.access_key),void 0!==e&&("id"in e||"email"in e)&&(this.utils.validateEmail(e.id)||this.utils.validateEmail(e.email))){i.user_id=e.id,i.object_id=e.id,i.user=e;for(var s in e)i[s]=e[s];this.utils.post(i,t,!1)}},this.searchProduct=function(e,t,i){i=this.utils.validateArgument(i,!0);var s={user_type:"guest",action_type:"search",object_type:"product"};if(this.access_key.length>0&&(s.access_key=this.access_key),void 0!==e&&(("id"in e||"email"in e)&&((this.utils.validateEmail(e.id)||this.utils.validateEmail(e.email))&&(s.user_type="email"),s.user_id=e.id),s.user=e),void 0!==t){"query"in t&&(s.object_id=t.query,delete t.query);for(var o in t)s[o]=t[o]}this.utils.post(s,i,!1)},this.visitWebsite=function(e){e=this.utils.validateArgument(e,!0),action={user_type:"guest",object_type:"website",action_type:"visit",object_id:window.location.hostname},this.access_key.length>0&&(action.access_key=this.access_key),this.utils.post(action,e,!1)},this.notifyAction=function(e,t){t=this.utils.validateArgument(t,!0),e.user_type="guest","user"in e?"id"in e.user&&this.utils.validateEmail(e.user.id)?(e.user_type="email",e.user_id=e.user.id):"email"in e.user&&this.utils.validateEmail(e.user.email)?(e.user_type="email",e.user_id=e.user.email):"user_id"in e&&this.utils.validateEmail(e.user_id)?e.user_type="email":"id"in e.user&&(e.user_id=e.user.id):"user_id"in e&&this.utils.validateEmail(e.user_id)&&(e.user_type="email"),this.utils.post(e,t,!1)}},YFretLogger=function(){this.log=function(e,t,i){e=e||"info",group="%cYFret debugger",group_format="color: blue; font-weight: bold",t&&(t="%c"+t,header_format="color: black",console[e](group+" "+t,group_format,header_format)),i&&("string"==typeof i?console[e](group+" %c"+i,group_format,header_format):(console[e](group+" %cevent parameters",group_format,header_format),console[e](i)))},this.ifExists=function(e,t){return t in e&&null!=e[t]&&void 0!=e[t]&&e[t].toString().length>0},this.checkEventParams=function(e){var t=!1;if(this.ifExists(e,"action_type")){if("track_session"==e.action_type)return void this.log("info","track session fired");if("visit"==e.action_type)return void this.log("info","visit event fired");"track_session"==e.action_type||this.ifExists(e,"object_type")||(t=!0,this.log("error","object_type is missing","make sure object(product) is passed to the API"),this.log("error",null,e))}else t=!0,this.log("error","event_type is missing","make sure the right event API is called"),this.log("error",null,e);if(this.ifExists(e,"user_type")){if("email"==e.user_type)this.ifExists(e,"user_id")||(t=!0,this.log("error","Used id missing for signed in user"),this.log("error",null,e));else if(-1!=["view","add_to_cart","remove_from_cart"].indexOf(e.action_type))this.ifExists(e,"object_id")||(t=!0,this.log("error",e.action_type+" event - product ID is missing (object_id)","make sure that the product object has product_id"),this.log("error",null,e));else if("place_order"==e.action_type)if(this.ifExists(e,"meta")){var s=e.meta.orders;if(void 0==s||null==s||s.length<=0)t=!0,this.log("error","Place order - products are missing"),this.log("error",null,e);else{"string"==typeof s&&(s=JSON.parse(s));for(i=0;i<s.length;i++){if(!this.ifExists(s[i],"id")){this.log("error","Place order - product ID is missing in products ordered"),this.log("error",null,e),t=!0;break}this.ifExists(s[i],"qty")||this.log("warn","Place order - quantity is missing, will be assumed as 1")}}}else t=!0,this.log("error","Place order - products are missing"),this.log("error",null,e)}else t=!0,this.log("error","user_type is missing","pass an empty object - {} for user if the user is not signed in"),this.log("error",null,e);t||this.log("info",e.object_type+" "+e.action_type+" event fired")},this.checkResponse=function(e){this.log("info","YFret event ID - "+e.id)}},TTUtils=function(){this.prev_tt_sid=null,this.addSessionProduct=function(e,t){var i="yrsn";"positive"==e&&(i="yrsp");var s=window.localStorage.getItem(i),o=window.localStorage.getItem(i+"e");s?(s=JSON.parse(s),o=JSON.parse(o),remove_pos=s.indexOf(t),-1!=remove_pos&&(s.splice(remove_pos,1),o.splice(remove_pos,1)),s.push(t),o.push((new Date).getTime().toString()),s.length>7&&(s=s.slice(s.length-7),o=o.slice(s.length-7)),s=JSON.stringify(s),o=JSON.stringify(o)):(s=JSON.stringify([t]),o=JSON.stringify([(new Date).getTime().toString()])),window.localStorage.setItem(i,s),window.localStorage.setItem(i+"e",o)},this.removeSessionProduct=function(e,t){var i="yrsn";"positive"==e&&(i="yrsp");var s=window.localStorage.getItem(i),o=window.localStorage.getItem(i+"e");s&&(s=JSON.parse(s),o=JSON.parse(o),remove_pos=s.indexOf(t),-1!=remove_pos&&(s.splice(remove_pos,1),o.splice(remove_pos,1),s=JSON.stringify(s),o=JSON.stringify(o),window.localStorage.setItem(i,s),window.localStorage.setItem(i+"e",o)))},this.getParameterByName=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var i=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null},this.debug=!1,(1==this.getParameterByName("yfret_debug")||window.sessionStorage.getItem("yfret_debug"))&&(this.debug=!0),this.logger=new YFretLogger,this.validateEmail=function(e){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)},this.createXMLHTTPObject=function(){for(var e=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],t=!1,i=0;i<e.length;i++){try{t=e[i]()}catch(e){continue}break}return t},this.get_tt_sid=function(){var e=Math.random().toString(),t=window.localStorage.getItem("tt_sid"),i=window.localStorage.getItem("tt_sid_epoch");return i&&(tt_sid_expired=(new Date-new Date(parseInt(i)))/6e4>30,tt_sid_expired||(this.prev_tt_sid=t)),window.localStorage.setItem("tt_sid",e),e},this.getFromLocalStorage=function(e,t){if(t=this.validateArgument(t,null),!(e in window.localStorage))return t;if(void 0!==window.localStorage[e])try{return JSON.parse(window.localStorage[e])}catch(t){return window.localStorage[e]}},this.validateArgument=function(e,t){return void 0===e?t:e},this.post=function(e,t,i){var s="",o="";if(e.api_version="1.1.0",Storage){if("event_id"in window.sessionStorage?s=window.sessionStorage.event_id:null==(s=this.checkCookie("tt_event_id"))&&(s=""),o=window.sessionStorage.getItem("tt_sid"),tt_sid_epoch=window.localStorage.getItem("tt_sid_epoch"),o?tt_sid_epoch&&(tt_sid_expired=(new Date-new Date(parseInt(tt_sid_epoch)))/6e4>30,tt_sid_expired||(o=null)):(o=this.get_tt_sid(),this.prev_tt_sid&&(e.prev_sid=this.prev_tt_sid,this.prev_tt_sid=null),window.sessionStorage.setItem("tt_sid",o)),window.localStorage.setItem("tt_sid_epoch",(new Date).getTime()),"ysa"in window.sessionStorage&&(e.sub_account=window.sessionStorage.getItem("ysa")),"yk"in window.sessionStorage&&(e.access_key=window.sessionStorage.getItem("yk")),document.referrer&&-1==document.referrer.indexOf(window.location.hostname))try{e.referrer=new URL(document.referrer).hostname}catch(t){e.referrer=document.referrer}this.getFromClientStorage("cem.subscriptionId")&&(e.browser_endpoint=this.getFromClientStorage("cem.subscriptionId"))}null!=s&&(e.event_id=s),null!=o&&(e.sid=o);var r=new Date,a=r.getTime(),n=r.getTimezoneOffset();n=n.toString(),e.tz=n,null==(d=this.checkCookie("tid"))&&(d=a.toString(),this.setCookie("tid",d,365)),e.tt_id=d;var d="";"tt_id"in window.localStorage?(e.tt_id=window.localStorage.tt_id,this.setCookie("tid",window.localStorage.tt_id,365)):(null==(d=this.checkCookie("tid"))?(d=a.toString(),window.localStorage.tt_id=d,this.setCookie("tid",d,365)):(window.localStorage.tt_id=d,this.setCookie("tid",d,365),e.new_user=1),e.tt_id=d);var l=window.location.protocol;for(key in e)if("object"==typeof e[key])try{e[key]=encodeURIComponent(JSON.stringify(e[key]))}catch(e){console.warn("[CEM ERROR] "+e.message);continue}var c=null;i?window.XDomainRequest&&(c=new XDomainRequest):c=this.createXMLHTTPObject();var u=this.pickUpOGTags();for(var _ in u)e[_]=u[_];var m=l+"//track.yfret.com/event/?when="+a;for(param in e)m+="&"+param+"="+e[param];var h=this;(null==c&&"undefined"==c||(this.debug&&(this.logger.checkEventParams(e),e.performEventChecks=1),c.open("GET",m,t),c.onload=function(e){var t=c.response,i=JSON.parse(t);h.debug&&h.logger.checkResponse(i),"id"in i&&Storage&&(window.sessionStorage.event_id=i.id,h.setCookie("tt_event_id",i.id))},c.send()),window.cemComponent&&window.cemComponent.webPush)&&(new window.cemComponent.webPush).checkEligibiltyForPush(e)},this.getCookie=function(e){for(var t=e+"=",i=document.cookie.split(";"),s=0;s<i.length;s++){for(var o=i[s];" "==o.charAt(0);)o=o.substring(1,o.length);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return null},this.pickUpOGTags=function(){for(var e=document.getElementsByTagName("meta"),t={},i=0;i<e.length;i++){var s=e[i].getAttribute("property"),o=e[i].getAttribute("content");"og:title"!=s&&"og:image"!=s||null==o||(t[s]=o)}return t["og:url"]=encodeURIComponent(window.location.href),t},this.setCookie=function(e,t,i){var s=new Date;s.setDate(s.getDate()+i);var o=escape(t)+(null==i?"":"; expires="+s.toUTCString());o+="; path=/",document.cookie=e+"="+o},this.getFromClientStorage=function(e,t){return t=this.validateArgument(t,e),window.localStorage.getItem(e)?window.localStorage.getItem(e):this.checkCookie(t)?this.checkCookie(t):null},this.checkCookie=function(e){var t=this.getCookie(e);return null!=t&&""!=t?t:null}},cemantika={ecommerce:new intendo,api:new intendo};!function(){var e=new TTUtils;(1==e.getParameterByName("yfret_debug")||window.sessionStorage.getItem("yfret_debug"))&&(e.debug=!0,window.sessionStorage.setItem("yfret_debug",1)),e.getParameterByName("yfret_source")||e.getParameterByName("yfret_campaign")||e.getParameterByName("yfret_medium")||e.getParameterByName("utm_source")||e.getParameterByName("utm_campaign")||e.getParameterByName("utm_medium")||e.getParameterByName("utm_content")||e.getParameterByName("yfret_utm_source")||e.getParameterByName("yfret_utm_campaign")||e.getParameterByName("yfret_utm_medium")||e.getParameterByName("yfret_utm_content")?cemantika.ecommerce.visitWebsite():window.sessionStorage.getItem("tt_sid")?window.localStorage.getItem("tt_sid_epoch")?(tt_sid_epoch=window.localStorage.getItem("tt_sid_epoch"),tt_sid_invalid=(new Date-new Date(parseInt(tt_sid_epoch)))/6e4>30,tt_sid_invalid&&cemantika.ecommerce.visitWebsite()):document.referrer&&-1==document.referrer.indexOf(window.location.hostname)&&cemantika.ecommerce.visitWebsite():cemantika.ecommerce.visitWebsite()}();